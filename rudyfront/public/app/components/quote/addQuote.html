<div class="dash_bord" ng-controller="addQuoteCtrl">
  <div class="panel_body" ng-init="getCommodityType()">
    <h3 class="heading_cls">
      <a ng-if="req.type=='buyer'" ng-href="buyerDetails/{{userId}}" class="back_arrow_cls"><i
          class="fa fa-arrow-left"></i></a>
      <a ng-if="req.type=='broker'" ng-href="brokerDetails/{{userId}}" class="back_arrow_cls"><i
          class="fa fa-arrow-left"></i></a>
      ADD QUOTE </h3>
    <hr class="heading_hr">

    <div class="head_buyer">
      <h3>{{req.type == 'buyer'?'Buyer Name':'Broker Name'}}: </h3>
      <p>{{buyerDetails.businessName}}</p>
    </div>

    <div class="panel_body_inner inner_box_List_add add_commodity no-vertical-scroll">
      <div class="col-md-12">
        <div class="add_commodity pro_con">
          <form name="addProductionContract" novalidate>
            <div class="grower_name">
              <div class="row">
                <div class="col-md-3 msps_inp">
                  <label>Interest Rate</label>
                  <input class="border1" type="text" numbers-Only ng-model="myForm.interestRate" placeholder="In Rate"
                    ng-change="countTotalPrice()">
                </div>
                <div class="col-md-3 msps_inp">
                  <label>No of Days</label>
                  <input class="border1" type="text" numbers-Only ng-model="myForm.interestDurationDays"
                    placeholder="No of Days" ng-change="countTotalPrice()">
                </div>
                <div class="col-md-3 msps_inp">
                  <label>Commission</label>
                  <select ng-model="myForm.commission" style="border: 1px solid #ececec;" ng-change="countTotalPrice()">
                    <option value=""> Select Commission</option>
                    <option value="0">0</option>
                    <option value="0.25">0.25</option>
                    <option value="0.50">0.50</option>
                    <option value="0.75">0.75</option>
                    <option value="1">1.00</option>
                    <option value="1.25">1.25</option>
                    <option value="1.50">1.50</option>
                    <option value="1.75">1.75</option>
                    <option value="2">2.00</option>
                    <option value="2.50">2.50</option>
                  </select>
                </div>
                <div class="col-md-3 msps_inp">
                  <label>Premium/Discount/MT</label>
                  <input class="border1" type="text" numbers-Only ng-model="myForm.premiumDiscount"
                    placeholder="Premium/Discount/MT" ng-change="countTotalPrice()">
                </div>
              </div>
              <div class="row">
                <div class="col-md-3 msps_inp">
                  <label>Insurance</label>
                  <input class="border1" type="text" numbers-Only ng-model="myForm.insurance" placeholder="Insurance"
                    ng-change="countTotalPrice()" position="4">
                </div>
                <div class="col-md-3 msps_inp">
                  <label>ARI Policy</label>
                  <input class="border1" type="text" numbers-Only ng-model="myForm.ariPolicy" placeholder="ARI Policy"
                    ng-change="countTotalPrice()" position="4">
                </div>
                <div class="col-md-3 msps_inp">
                  <label>Currency</label>
                  <select class="form-control border1" ng-model="myForm.currency" ng-change="countTotalPrice()">
                    <option value="">Select Currency</option>
                    <option value="USD">USD</option>
                    <option value="CAD">CAD</option>
                  </select>
                </div>
                <div class="col-md-3 msps_inp">
                  <label>Exchange</label>
                  <input class="border1" disabled type="text" numbers-Only ng-model="myForm.exchangeRate"
                    placeholder="Exchange" ng-change="countTotalPrice()">
                </div>
                <div class="row">
                  <div class="col-md-12 msps_inp big_wi">
                    <label>Weather Update</label>
                    <input class="border1" type="text" ng-model="weather.weather" placeholder="Weather Update"
                      ng-disabled="true">
                  </div>
                  <div class="col-md-12 msps_inp big_wi">
                    <label>Currency Update</label>
                    <input class="border1" disabled type="text" ng-model="currencyUpdate" placeholder="Currency Update"
                      ng-disabled="true">
                  </div>
                </div>
                <div class="row">
                  <p class="headersss">We are pleased to provide you with the following price indication updates based
                    on todays date, subject to reconfirmation By Rudy Agro Ltd.(Price {{myForm.currency}})</p>
                </div>
              </div>

              <div style="float: left;width: 100%;margin: 0;padding: 0;overflow-x: auto;">

                <div style="float: left;width: 2200px;margin: 0;padding: 0%">

                  <div style="float: left;width: 26.6%;margin: 0;padding: 0;">
                    <div style="float: right;width: 20%;margin: 0;padding: 15px 0 0;font-weight: 900;">

                      <div style="float: left;width: 100%;margin: 32px 0 0 0;padding: 0;">
                      </div>

                      <div class="side_hd">Loading Port</div>
                      <div class="side_hd">Shipping Term</div>
                      <div class="side_hd">Destination Port</div>
                      <div class="side_hd">Equipment</div>
                      <div class="side_hd">Bag</div>
                      <div class="side_hd">Freight By</div>
                      <div class="side_hd">Weight Type</div>
                      <div class="side_hd">Upcharge</div>
                    </div>
                  </div>

                  <div style="float: left;width: 73.4%;margin: 0;padding: 0;position: relative;">

                    <div
                      style="float: left;width: 11.11%;margin: 0;padding: 25px 10px 10px;border: 1px solid #000;border-radius: 5px;position: relative;"
                      ng-repeat="arr in rowArray">
                      <div ng-show="arr.loadingPortId"
                        style="float: left;width: 100%;margin: 0;padding: 10px 10px 0 0;text-align: right;position: absolute;top: 0; right: 0;">
                        <a ng-show="$last && arr.loadingPortId"
                          style="line-height: 20px;margin: 0 0 5px 0;float: right;" class="add_land_location"
                          ng-click="addNewCol(arr)">+</a>
                        <a ng-show="$last && !$first " style="line-height: 20px;margin: 0 0 5px 0;float: right;"
                          class="add_land_location" ng-click="removeCol($index)">x</a>
                      </div>
                      <div ng-show="!arr.loadingPortId"
                        style="float:left;width: 100%;margin: 0;padding: 0px;text-align: right;">
                      </div>

                      <div class="rit_side">

                        <select style="font-size: 13px;" class="form-control" name="loadingPort"
                          ng-options="loadingPort._id as loadingPort.loadingPortName for loadingPort in loadingPortList"
                          ng-model="arr.loadingPortId" ng-change="getShippingTerms(arr.loadingPortId,arr)">
                          <option value="">Select Loading Port</option>
                        </select>
                      </div>
                      <div class="rit_side2">
                        <select style="font-size: 13px;" class="form-control" name="shippingTerms"
                          ng-options="shipping._id as shipping.term for shipping in arr.shippingTermsList"
                          ng-model="arr.shippingtermsId" ng-change="getFreightDetails(arr)">
                          <option value="">Select Shipping Terms</option>
                        </select>
                      </div>
                      <div class="rit_side2">
                        <select style="font-size: 13px;" class="form-control" name="destinationPort"
                          ng-options="dt.cityName as dt.cityName for dt in arr.freightList"
                          ng-model="arr.destinationPort" ng-change="getFreightDetails(arr)">
                          <option value="">Select Destination Port</option>
                        </select>
                      </div>
                      <div class="rit_side2">
                        <select style="font-size: 13px;" class="form-control" name="equipmentId"
                          ng-options="equipment._id as equipment.equipmentName for equipment in arr.equipmentList"
                          ng-model="arr.equipmentId" ng-change="getFreightDetails(arr)">
                          <option value="">Select Equipment</option>
                        </select>
                      </div>
                      <div class="rit_side2">
                        <select style="font-size: 13px;" class="form-control" name="bags"
                          ng-options="bag._id as bag.name for bag in bagsList" ng-model="arr.bagId"
                          ng-change="countTotalPrice()">
                          <option value="">Select Bag</option>
                        </select>
                      </div>
                      <div class="rit_side2">
                        <select style="font-size: 13px;" class="form-control" name="freightById"
                          ng-model="arr.freightId" ng-change="getFreightDetails(arr, 'freightBy')">
                          <option value="">Select Freight By</option>
                          <option ng-repeat="freightBy in arr.freightCompanyList"
                            value="{{freightBy._id}}">{{freightBy.freightCompanyId.freightCompanyName}}
                            -
                            {{ arr.bagId ? freightBy.oceanFreight ? freightBy.oceanFreight.bagToBag : 0 : 0}}/{{ arr.bagId ? freightBy.oceanFreight ? freightBy.oceanFreight.bulkToBulk : 0 : 0}}
                          </option>

                        </select>
                      </div>
                      <div class="rit_side2">
                        <select style="border: 1px solid #ececec; font-size: 13px;" class="form-control"
                          ng-model="arr.weightType" ng-change="countTotalPrice()">
                          <option value="">Select Weight</option>
                          <option value="MT">MT</option>
                          <option value="CWT">CWT</option>
                        </select>
                      </div>
                      <div
                        style="float: left;width: 100%;margin: 0;padding: 0;height: 30px;border: 1px solid #000;font-size: 13px;">
                        <input style="font-size: 13px;" type="text" ng-model="arr.upChange" placeholder="Enter upcharge"
                          ng-change="countTotalPrice()">
                      </div>
                    </div>
                  </div>

                </div>

                <div style="float: left;width: 2200px;margin: 0px;padding: 0;">
                  <div style="float: left;width: 26.6%;margin: 0;padding: 0;">
                    <div style="float: left;width: 100%;margin: 0;padding: 0;font-weight: 900;">
                      <div style="float: left;width: 25%;margin: 0;padding: 0;height: 40px;text-align: center;">
                        Commodity</div>
                      <div style="float: left;width: 25%;margin: 0;padding: 0;height: 40px;text-align: center;">Grade
                      </div>
                      <div style="float: left;width: 12%;margin: 0;padding: 0;height: 40px;text-align: center;">Crop Yr
                      </div>
                      <div style="float: left;width: 10%;margin: 0;padding: 0;height: 40px;text-align: center;">Shipping
                        Period</div>

                      <div style="float: left;width: 13%;margin: 0;padding: 0;height: 40px;text-align: center;">QA</div>

                      <div style="float: left;width: 10%;margin: 0;padding: 0;height: 40px;text-align: center;">Upcharge
                      </div>

                    </div>
                  </div>
                </div>

                <div style="float: left;width: 2300px;margin: 0px;padding: 0;height: 300px;overflow-y: auto;">
                  <div style="float: left;width: 2200px;margin: 0px;padding: 0;"
                    ng-repeat="commArr in commodityRowArray" drag-drop>
                    <div style="float: left;width: 26.6%;margin: 0;padding: 0;">
                      <div style="float: left;width: 100%;margin: 0;padding: 0;">
                        <div style="float: left;width: 25%;margin: 0;padding: 0;height: 30px;">
                          <select style="font-size: 12px;border: 1px solid #ececec;height: 30px;" name="commodity"
                            ng-options="commodity._id as commodity.commodityName for commodity in commoditys"
                            ng-model="commArr.commodityId " ng-change="getGrade(commArr.commodityId,commArr)"
                            ng-selected="commArr.commodityId">
                            <option value="">Select Commodity</option>
                          </select>
                        </div>
                        <div style="float: left;width: 25%;margin: 0;padding: 0;height: 30px; ">
                          <select ng-disabled="!commArr.commodityId "
                            style="font-size: 12px;border: 1px solid #ececec;height: 30px; " name="grade "
                            ng-options="grade._id as grade.gradeName  for grade in commArr.grades "
                            ng-model="commArr.gradeId" ng-change="getCommodityPriceDetails(commArr)"
                            ng-selected="commArr.gradeId">
                            <option value="">Select Grade</option>
                          </select>
                        </div>
                        <div style="float: left;width: 12%;margin: 0;padding: 0;height: 30px;">
                          <select ng-disabled="!commArr.commodityId && !commArr.gradeId"
                            style="font-size: 12px;border: 1px solid #ececec;height: 30px;" ng-model="commArr.cropYear"
                            ng-change="getCommodityPriceDetails(commArr)">
                            <option value="">Crop Year</option>
                            <option value="2017">2017</option>
                            <option value="2018">2018</option>
                            <option value="2019">2019</option>
                            <option value="2020">2020</option>
                            <option value="2021">2021</option>
                          </select>
                        </div>
                        <div
                          style="float: left;width: 10%;margin: 0;padding: 5px;height: 30px;font-size: 12px;border: 1px solid #ececec;overflow: hidden;"
                          title="{{commArr.shippingPeriod}}">{{commArr.shippingPeriodShort}}</div>

                        <div
                          style="overflow: hidden; float: left;width: 13%;white-space: nowrap;margin: 0;padding: 5px;height: 30px;font-size: 12px;border: 1px solid #ececec;"
                          title="{{commArr.quantity}}">{{commArr.quantity}}</div>
                        <div
                          style="float: left;width: 10%;margin: 0;padding: 5px;height: 30px;font-size: 12px;border: 1px solid #ececec;">
                          <input type="text" name="upcharge" placeholder="_" ng-model="commArr.upCharge"
                            ng-change="countTotalPrice()">
                        </div>
                      </div>
                    </div>
                    <div style="float: left;width: 73.4%;margin: 0;padding: 0;position: relative;">
                      <div style="float: left;width: 100%;margin: 0;padding: 0;">

                        <div class="tooltip_box" ng-repeat="col in columns">
                          <p>{{commArr[col] | number:2}}</p>
                          <div class="tooltip_sus">
                            === {{myForm.currency}} ===
                            <br> CC => {{commArr[col + 'totalCost'].finalCommodityCost}}
                            <br> SC => {{commArr[col + 'totalCost'].finalPortPrice}}
                            <br> Prem =>{{commArr[col + 'totalCost'].priceDiscount}}
                            <br> Int => {{commArr[col + 'totalCost'].interestCost}}
                            <br> Cmsn => {{commArr[col + 'totalCost'].commissionPaid}}
                            <br> Ins => {{commArr[col + 'totalCost'].insurancePaid}}
                            <br> Ari => {{commArr[col + 'totalCost'].ariInsurancePaid}}
                            <br> Bag => {{commArr[col + 'totalCost'].bagCostUsd}}
                          </div>
                        </div>
                      </div>

                      <div
                        style="position: absolute;right: -50px;top: 4px;float: left;width: auto;margin: 0;padding: 0px;text-align: right;">
                        <a ng-show="$last" style="line-height: 20px;margin: 0 0 5px 0;float: right;"
                          class="add_land_location" ng-click="addNewRow($index)">+</a>
                        <a ng-show="$last && commodityRowArray.length >1"
                          style="line-height: 20px;margin: 0 0 5px 0;float: right;" class="add_land_location"
                          ng-click="removeRow($index)">x</a>
                      </div>

                    </div>

                  </div>
                </div>

              </div>

            </div>
            <button ng-click="submitData()">Submit</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
